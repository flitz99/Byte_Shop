{% extends 'base.html' %}

{% block head %}

{% load static %}
<link rel="stylesheet" type="text/css" href="{% static '/css/style.css' %}">

{% endblock %}

{% block title %}{{title}} {% endblock %}

{% block content %}


<header class="header">

    <!-- Top Bar -->
    <div class="top_bar">
        <div class="container">
            <div class="row">
                <div class="col d-flex flex-row">
                    <div class="top_bar_contact_item"><div class="top_bar_icon"><img src="{% static '/img/phone.png' %}" class="img-fluid"></div>+39 349 18234567</div>
                    <div class="top_bar_contact_item"><div class="top_bar_icon"><img src="{% static '/img/mail.png' %}"  class="img-fluid"></div>contact@byteshop.com</div>
                    <div class="top_bar_content ml-auto">
                        <div class="top_bar_menu">
                            <ul class="standard_dropdown top_bar_dropdown">
                                <li>
                                    <a> Italian <i class="fas fa-chevron-down"> </i> </a>
                                </li>
                                <li>
                                    <a> € EUR <i class="fas fa-chevron-down"> </i></a> 
                                </li>
                            </ul>
                        </div>
                        {% if user.is_authenticated %}
                        <div class="top_bar_user">
                            <div class="user_icon"><img src="{% static '/img/user.svg' %}"  class="img-fluid"></div>
                            <a>Benvenuto, {{user.username}}! </a>
                        </div>
                        
                        {% else%}

                        <div class="top_bar_user">
                            <div class="user_icon"><img src="{% static '/img/user.svg' %}"  class="img-fluid"></div>
                            <div><a href="authentication/client/signup">Register</a></div>
                            <div><a href="authentication/client/signin">Sign in</a></div>
                        </div>
                        {%endif%}
                    </div>
                </div>
            </div>
        </div>		
    </div>

    <!-- Header Main -->

    <div class="header_main">
        <div class="container">
            <div class="row">

                <!-- Logo -->
                <div class="col-lg-2 col-sm-3 col-3 order-1">
                    <div class="logo_container">
                        <div class="logo"> <a href=" "> <img src="{% static '/img/byte_shop_logo.png' %}" class="img-fluid" alt="logo"> </a> </div>
                    </div>
                </div>

                <!-- Search -->
                <div class="col-lg-6 col-12 order-lg-2 order-3 text-lg-left text-right">
                    <div class="header_search">
                        <div class="header_search_content">
                            <div class="header_search_form_container">
                                <form method="GET" action="{% url 'products:search' %}" class="header_search_form clearfix" >
                                    <input type="search" name="search" required="required" class="header_search_input" placeholder="Search for products...">
                                    <button type="submit" class="header_search_button trans_300" value="Submit"><img src="{% static '/img/search.png' %}" class="img-fluid" ></button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- My orders -->
                {% if user.is_authenticated %}
                <div class="col-lg-4 col-9 order-lg-3 order-2 text-lg-left text-right">
                    <div class="orders_cart d-flex flex-row align-items-center justify-content-end">
                        <div class="orders d-flex flex-row align-items-center justify-content-end">
                            <div class="orders_icon"><img src="{% static '/img/shop_cart.jpg' %}"height="30" width="20"  alt=""></div>
                            <div class="orders_content">
                                <div class="orders_text"><a href="products/orders/{{user.id}}">I miei ordini</a></div>
                            </div>
                        </div>

                        <!-- My profile-->
                        <div class="profile">
                            <div class="profile_container d-flex flex-row align-items-center justify-content-end">
                                <div class="profile_icon">
                                    <img src="{% static '/img/icona_profilo.png' %}" height="30" width="20" alt="">
                                </div>
                                <div class="profile_content">
                                    <div class="profile_text"><a href="authentication/profile"> Mio profilo</a></div>
                                </div>
                                {% if user.is_authenticated %}
                                <div class="logout-content">
                                    <button type="button" class="btn btn-link"><a href="authentication/signout">  Logout </a> </button>
                                </div>
                                {% endif%}
                            </div>
                        </div>
                    </div>
                </div>
                {% endif%}
            </div>
        </div>
    </div>
    
    <!-- Main Navigation -->

    <nav class="main_nav">
        <div class="container">
            <div class="row">
                <div class="col">
                    
                    <div class="main_nav_content d-flex flex-row">

                        <!-- Categories Menu -->

                        <!-- Main Nav Menu -->

                        <div class="main_nav_menu">
                            <ul class="standard_dropdown main_nav_dropdown">
                                <li><a href=" ">Home<i class="fas fa-chevron-down"></i></a></li>

                                {% if user.is_authenticated and user.is_staff%}
                                <li class="hassubs">
                                        <a href="#">Aggiungi Prodotto<i class="fas fa-chevron-down"></i></a>
                                        <ul>
                                            <li>
                                                <a href="products/add_product/computer">Computer<i class="fas fa-chevron-down computer"></i></a>
                                            </li>
                                            <li>
                                                <a href="products/add_product/smartphone">Smartphone<i class="fas fa-chevron-down smartphone"></i></a>
                                            </li>
                                        </ul>
                                </li>
                                <li class="hassubs">
                                    <a href="authentication/users">Gestisci Utenti<i class="fas fa-chevron-down"></i></a> 
                                </li>
                                {% else %}
                                <li class="hassubs">
                                        <a href="#">Categorie<i class="fas fa-chevron-down"></i></a>
                                        <ul>
                                            <li>
                                                <a href="products/results/?search=computer">Computer<i class="fas fa-chevron-down"></i></a>
                                            </li>
                                            <li>
                                                <a href="products/results/?search=smartphone">Smartphone<i class="fas fa-chevron-down"></i></a>
                                            </li>
                                        </ul>
                                </li>
                                {% endif %}
                                
                            </ul>
                        </div>
                        
                    </div>
                </div>
            </div>
        </div>
    </nav>

</header>


<!-- Visualizzazione prodotti -->
<center>

    
    {% if user.is_authenticated and user.is_staff%} <!--Se utente autenticato è amministratore -->
        <br>
        <br>
        <h3> Prodotti che hai inserito: </h3>
    {% endif %}
   
    {% if listaprodotti.count > 0%}
    <div class="container-fluid">
        <div class="row">
        {% for l in listaprodotti %}
                <div class="col-3">
                        <br> <br>
                        <p> <h3> <b> {{ l.name }} </b></h3> </p>

                        {% if user.is_authenticated and user.is_staff%}
                            <img src="{{ l.image.url }}" class="img-thumbnail">
                            <br>
                            <button type="submit" onclick="location.href='products/update_product/{{l.id}}'" class="btn btn-primary btn-sm update"> Modifica </button>
                            <button class="btn btn-primary btn-sm delete" type="submit" onclick="return confirm('Sei sicuro di voler eliminare il prodotto?')"> <a href="products/delete_product/{{l.id}}">  Elimina </a> </button> 
                        {% else %}
                        <a href = "products/category/{{l.product_code}}"> <img src="{{ l.image.url }}" style="width: 100%;">  </a>   <!--collegamento a specifiche prodotto -->
                        {% endif %}
                </div>
        {% endfor%}
        </div>
    </div>
    {% else %}
        Nessun prodotto caricato.
    {% endif %}
   <br> <br>

   {% if  not user.is_authenticated %} <!--Se utente non autenticato -->
    <form class="admin_access">
        <h4> Accesso amministratori: </h4>
        <a href="authentication/admin/signin"> <h5> Login </h5> </a> 
    </form>
    {%endif%}

</center>

{% endblock %}